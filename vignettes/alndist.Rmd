---
title: "alndist"
author: "Yue Jiang"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{alndist}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r}
# fs <- list.files("data", full.names = T)
# for (f in fs) load(f)
#
# fs2 <- gsub(".rda", "", list.files("data"))
# for (f in fs2) {
#   mtx <- get(f)
#   colnames(mtx)[colnames(mtx) == "*"] <- "-"
#   rownames(mtx)[rownames(mtx) == "*"] <- "-"
#   saveRDS(mtx, file.path("inst", "extdata", paste0(f, ".rds")))
# }

or <- seqinr::read.fasta(system.file("extdata/mouseOR.fasta", package="alndist"), seqtype="AA")
x <- toupper(as.character(or[[1]]))
mtx <- get_substitute_mtx("BLOSUM62")
seq_to_idx(x, mtx)
weights <- runif(length(x), 0, 1)
two_seq_score(x, x, mtx, weights)

lst <- purrr::map(or, ~toupper(as.character(.x)))
names(lst) <- purrr::map(or, ~attr(.x, "Annot"))
pairwise_score(lst[1:3], mtx, weights)
```
